function [sf,Y,Z] = node_admittance(h,k)
y1_2 = 1/(0.01938+1i*0.05917*h);
y1_5 = 1/(0.05403+1i*0.22304*h);
y2_3 = 1/(0.04699+1i*0.19797*h);
y2_4 = 1/(0.05811+1i*0.17632*h);
y2_5 = 1/(0.05695+1i*0.17388*h);
y3_4 = 1/(0.06701+1i*0.17103*h);
y4_5 = 1/(0.01335+1i*0.04211*h);
y6_11 = 1/(0.09498+1i*0.19890*h);
y6_12 = 1/(0.12291+1i*0.25581*h);
y6_13 = 1/(0.06615+1i*0.13027*h);
y7_8 = 1/(0+1i*0.17615*h);
y7_9 = 1/(0+1i*0.11001*h);
y9_10 = 1/(0.03181+1i*0.08450*h);
y9_14 = 1/(0.12711+1i*0.27038*h);
y10_11 = 1/(0.08205+1i*0.19207*h);
y12_13 = 1/(0.22092+1i*0.19988*h);
y13_14 = 1/(0.17093+1i*0.34802*h);
y4_7 = 1/(1i*0.20912*h);
y4_9 = 1/(1i*0.55618*h);
y5_6 = 1/(1i*0.25202*h);

y12g = 1i*0.0264/h;
y15g = 1i*0.0246/h;
y23g = 1i*0.0219/h;
y24g = 1i*0.0170/h;
y25g = 1i*0.0173/h;
y34g = 1i*0.0064/h;

y2ld = (20+1i*5*h)/230*230;
y3ld = y2ld;
y4ld = y2ld;
y5ld = y2ld;
y6ld = y2ld;
y9ld = y2ld;
y10ld = y2ld;
y11ld = y2ld;
y12ld = y2ld;
y13ld = y2ld;
y14ld = y2ld;

Y = zeros(14,14);
Y(1,1) = y1_2 + y1_5 + y12g + y15g;
Y(2,2) = y1_2 + y2_3 + y2_4 + y2_5 + y12g + y23g + y24g + y25g + y2ld;
Y(3,3) = y2_3 + y2_4 + y23g + y24g + y3ld;
Y(4,4) = y2_4 + y3_4 + y4_5 + y4_7 + y4_9 + y24g + y34g + y4ld;
Y(5,5) = y1_5 + y2_5 + y4_5 + y5_6 + y15g + y25g + y5ld;
Y(6,6) = y5_6 + y6_11 + y6_12 + y6_13 + y6ld;
Y(7,7) = y4_7 + y7_8 + y7_9;
Y(8,8) = y7_8;
Y(9,9) = y4_9 + y7_9 + y9_10 + y9_14 + y9ld;
Y(10,10) = y9_10 + y10_11 + y10ld;
Y(11,11) = y6_11 + y10_11 + y11ld;
Y(12,12) = y6_12 + y12_13 + y12ld;
Y(13,13) = y6_13 + y12_13 + y13_14 + y13ld;
Y(14,14) = y9_14 + y13_14 + y14ld;

Y(1,2) = y1_2;
Y(2,1) = y1_2;
Y(1,5) = y1_5;
Y(5,1) = y1_5;
Y(2,3) = y2_3;
Y(3,2) = y2_3;
Y(2,4) = y2_4;
Y(4,2) = y2_4;
Y(2,5) = y2_5;
Y(5,2) = y2_5;
Y(3,4) = y3_4;
Y(4,3) = y3_4;
Y(4,5) = y4_5;
Y(5,4) = y4_5;
Y(6,11) = y6_11;
Y(11,6) = y6_11;
Y(6,12) = y6_12;
Y(12,6) = y6_12;
Y(6,13) = y6_13;
Y(13,6) = y6_13;
Y(7,8) = y7_8;
Y(8,7) = y7_8;
Y(7,9) = y7_9;
Y(9,7) = y7_9;
Y(9,10) = y9_10;
Y(10,9) = y9_10;
Y(9,14) = y9_14;
Y(14,9) = y9_14;
Y(10,11) = y10_11;
Y(11,10) = y10_11;
Y(12,13) = y12_13;
Y(13,12) = y12_13;
Y(13,14) = y13_14;
Y(14,13) = y13_14;
Y(4,7) = y4_7;
Y(7,4) = y4_7;
Y(4,9) = y4_9;
Y(9,4) = y4_9;
Y(5,6) = y5_6;
Y(6,5) = y5_6;

Z = inv(Y);

sf1_2 = max(abs((y1_2 + y12g + y15g)*Z(1,k) - y1_2*Z(2,k))+abs((y1_2 + y12g + y23g + y24g + y25g)*Z(1,k) - y1_2*Z(2,k)));
sf1_5 = max(abs((y1_5 + y12g + y15g)*Z(1,k) - y1_5*Z(5,k))+abs((y1_5 + y15g + y25g)*Z(1,k) - y1_5*Z(5,k)));
sf2_3 = max(abs((y2_3 + y12g + y23g + y24g + y25g)*Z(2,k) - y2_3*Z(3,k))+abs((y2_3 + y23g + y34g)*Z(2,k) - y2_3*Z(3,k)));
sf2_4 = max(abs((y2_4 + y12g + y23g + y24g + y25g)*Z(2,k) - y2_4*Z(4,k))+abs((y2_4 + y24g + y34g)*Z(2,k) - y2_4*Z(4,k)));
sf2_5 = max(abs((y2_5 + y12g + y23g + y24g + y25g)*Z(2,k) - y2_5*Z(5,k))+abs((y2_5 + y15g + y25g)*Z(2,k) - y2_5*Z(5,k)));
sf3_4 = max(abs((y3_4 + y23g + y34g + y23g + y34g)*Z(3,k) - y3_4*Z(4,k))+abs((y3_4 + y24g + y34g)*Z(3,k) - y3_4*Z(4,k)));
sf4_5 = max(abs((y4_5 + y24g + y34g)*Z(4,k) - y4_5*Z(5,k))+abs((y4_5 + y15g + y25g)*Z(4,k) - y4_5*Z(5,k)));
sf6_11 = abs((y6_11)*Z(6,k) - y6_11*Z(11,k));
sf6_12 = abs((y6_12)*Z(6,k) - y6_12*Z(12,k));
sf6_13 = abs((y6_13)*Z(6,k) - y6_13*Z(13,k));
sf7_8 = abs((y7_8)*Z(7,k) - y7_8*Z(8,k));
sf7_9 = abs((y7_9)*Z(7,k) - y7_9*Z(9,k));
sf9_10 = abs((y9_10)*Z(9,k) - y9_10*Z(10,k));
sf9_14 = abs((y9_14)*Z(9,k) - y9_14*Z(14,k));
sf10_11 = abs((y10_11)*Z(10,k) - y10_11*Z(11,k));
sf12_13 = abs((y12_13)*Z(12,k) - y12_13*Z(13,k));
sf13_14 = abs((y13_14)*Z(13,k) - y13_14*Z(14,k));
sf4_7 = max(abs((y4_7 + y24g + y34g)*Z(4,k) - y4_7*Z(7,k))+abs(y4_7*Z(4,k) - y4_7*Z(7,k)));
sf4_9 = max(abs((y4_9 + y24g + y34g)*Z(4,k) - y4_9*Z(9,k))+abs(y4_9*Z(4,k) - y4_9*Z(9,k)));
sf5_6 = max(abs((y5_6 + y15g + y25g)*Z(5,k) - y5_6*Z(6,k))+abs(y5_6*Z(5,k) - y5_6*Z(6,k)));

sf = [sf1_2;sf1_5;sf2_3;sf2_4;sf2_5;sf3_4;sf4_5;sf6_11;sf6_12;sf6_13;sf7_8;sf7_9;sf9_10;sf9_14;sf10_11;sf12_13;sf13_14;sf4_7;sf4_9;sf5_6];

end